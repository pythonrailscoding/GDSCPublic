{% extends 'base.html' %}
{% load static %}
{% block title %}
    {% if is_other %}
        View all Blogs!
    {% else %}
        Home
    {% endif %}
{% endblock %}
{% block content %}
<div>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">

    <div style="background-color: #0c0b0b; border-left: 4px solid #f44336; padding: 6px 10px; margin-bottom: 12px; font-size: 14px;">
  <strong>‚ö†Ô∏è Note:</strong> Media uploads won‚Äôt be stored. I need Amazon S3 or other cloud storage for that. üòÖ Ran out of time for that!
</div>
    <main class="container">
    <h1 class="page-title">

        {% if not is_other %}
            Latest Blogs
        {% else %}
            {% if request.user.is_authenticated %}
                {% if request.user.id == user.id %}
                    View all of your blogs!!
                    {% endif %}
                {% endif %}
            {% if request.user.id != user.id %}
            View all blogs from {{ user.username }}
                {% endif %}
        {% endif %}
    </h1>

    <section class="card-grid">
      {% for card in blogs %}
        <article class="card">
          <a class="card-media" {% if card.thumbnail %}href="{{ card.thumbnail.url }}" target="_blank" rel="noopener" {% else %}href="#"{% endif %}>
            {% if card.thumbnail %}
              <img
                src="{{ card.thumbnail.url }}"
                alt="{{ card.title }}"
                loading="lazy"
                width="640" height="400">
            {% else %}
              <div class="card-placeholder" aria-hidden="true">
                <span>{{ card.title|first|upper }}</span>
              </div>
            {% endif %}
          </a>

          <div class="card-body">
            <h2 class="card-title">
                {% with long_text=card.title %}
                    {{ card.title|truncatechars:25 }}
                {% endwith %}
            </h2>

              <p class="card-desc">
                  {% if is_other %}
                        {% if request.user.is_authenticated %}
                      {% if user.id == request.user.id %}
                          <a href="{% url 'profile_user' card.user.id %}" class="underline-special">You</a>
                            posted this on {{ card.date }}, {{ card.time }}
                          {% endif %}

                            {% endif %}
                      {% if request.user.id != user.id %}
                          <a href="{% url 'profile_user' card.user.id %}" class="underline-special">{{ card.user.username }}</a>
                            posted this on {{ card.date }}, {{ card.time }}
                          {% endif %}
                  {% else %}
                    <a href="{% url 'profile_user' card.user.id %}" class="underline-special">{{ card.user.username }}</a>
                    posted this on {{ card.date }}, {{ card.time }}
                  {% endif %}
              </p>

            <a href="{% url 'view_blog' card.pk %}" class="btn-card">Read More</a>
          </div>
        </article>
      {% empty %}
        <p>No blogs posted yet!!</p>
      {% endfor %}
    </section>
  </main>

    {% if blogs.has_other_pages %}
<nav class="pagination-container">
    <ul class="pagination">

        <!-- Previous Button -->
        {% if blogs.has_previous %}
            <li>
                <a href="?page={{ blogs.previous_page_number }}" class="page-link">&laquo;</a>
            </li>
        {% else %}
            <li class="disabled"><span>&laquo;</span></li>
        {% endif %}

        <!-- Page Numbers -->
        {% for num in blogs.paginator.page_range %}
            {% if blogs.number == num %}
                <li class="active"><span>{{ num }}</span></li>
            {% elif num > blogs.number|add:'-3' and num < blogs.number|add:'3' %}
                <li><a href="?page={{ num }}" class="page-link">{{ num }}</a></li>
            {% endif %}
        {% endfor %}

        <!-- Next Button -->
        {% if blogs.has_next %}
            <li>
                <a href="?page={{ blogs.next_page_number }}" class="page-link">&raquo;</a>
            </li>
        {% else %}
            <li class="disabled"><span>&raquo;</span></li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% endblock %}
</div>
